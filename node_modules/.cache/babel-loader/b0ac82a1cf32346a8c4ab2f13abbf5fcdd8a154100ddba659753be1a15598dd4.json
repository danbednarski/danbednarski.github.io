{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'./guestbook.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Guestbook(){const[posts,setPosts]=useState([]);const[filename,setFilename]=useState('');const[file,setFile]=useState(null);const[subject,setSubject]=useState('');const[content,setContent]=useState('');useEffect(()=>{window.scrollTo(0,0);window.scrollTo=function(){};},[]);useEffect(()=>{const ws=new WebSocket(\"ws://\".concat(process.env.REACT_APP_BACKEND_URL));ws.onopen=()=>{console.log('WebSocket Connected');ws.send('Hello Server!');};ws.onmessage=event=>{const message=JSON.parse(event.data);if(message.action==='new_post'){setPosts(prevPosts=>prevPosts.concat(message.data));}else{setPosts(posts.concat(message));// Update all posts if the initial data or refresh\n}};ws.onerror=error=>{console.log('WebSocket Error: ',error);};ws.onclose=()=>{console.log('WebSocket Disconnected');};return()=>{ws.close();};},[]);return/*#__PURE__*/_jsxs(\"div\",{id:\"chan\",style:{overflow:\"scroll\"},children:[/*#__PURE__*/_jsxs(\"header\",{style:{display:'flex',flexDirection:'column',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{id:\"title\",children:\"33chan\"}),/*#__PURE__*/_jsx(\"p\",{style:{width:'400px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"i\",{children:\"An anonymous imageboard.\"})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:async e=>{// upload to backend...\ne.preventDefault();if(file===null){alert('Please include image...');return;}const formData=new FormData();formData.append('subject',subject);formData.append('content',content);if(file){formData.append('file',file);}try{await axios.post(\"http://\".concat(process.env.REACT_APP_BACKEND_URL,\"/posts\"),formData,{headers:{'Content-Type':'multipart/form-data'}});setSubject('');setContent('');setFilename('');setFile(null);alert('Post created successfully!');}catch(error){console.error('Error uploading post:',error);alert('Error uploading post!');}return false;},style:{maxWidth:\"fit-content\"},children:[/*#__PURE__*/_jsx(\"input\",{name:\"subject\",onChange:e=>setSubject(e.target.value),value:subject,placeholder:\"Subject...\",type:\"text\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"textarea\",{name:\"content\",onChange:e=>setContent(e.target.value),value:content,placeholder:\"Say hi!\",rows:3,cols:25}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{name:\"file\",style:{width:'230px'},onChange:e=>{setFilename(e.target.value);setFile(e.target.files[0]);},value:filename,type:\"file\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\"})]})]}),/*#__PURE__*/_jsx(\"hr\",{}),posts.map(p=>/*#__PURE__*/_jsxs(\"div\",{className:\"post-container\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Subject: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"post-subject\",children:p.subject}),/*#__PURE__*/_jsx(\"br\",{}),p.file?/*#__PURE__*/_jsx(\"img\",{style:{float:'left',maxWidth:'100px',maxHeight:'100px'},src:\"http://\".concat(process.env.REACT_APP_BACKEND_URL,\"/\").concat(p.file)}):'',/*#__PURE__*/_jsx(\"span\",{id:\"\",children:/*#__PURE__*/_jsx(\"span\",{className:\"post-content\",children:p.content})})]}))]});}export default Guestbook;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","Guestbook","posts","setPosts","filename","setFilename","file","setFile","subject","setSubject","content","setContent","window","scrollTo","ws","WebSocket","concat","process","env","REACT_APP_BACKEND_URL","onopen","console","log","send","onmessage","event","message","JSON","parse","data","action","prevPosts","onerror","error","onclose","close","id","style","overflow","children","display","flexDirection","alignItems","width","textAlign","onSubmit","e","preventDefault","alert","formData","FormData","append","post","headers","maxWidth","name","onChange","target","value","placeholder","type","rows","cols","files","map","p","className","float","maxHeight","src"],"sources":["/Users/eliana/Documents/Code/homepage/src/Guestbook.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport './guestbook.css';\n\nfunction Guestbook() {\n  const [posts, setPosts] = useState([])\n  const [filename, setFilename] = useState('');\n  const [file, setFile] = useState(null)\n  const [subject, setSubject] = useState('')\n  const [content, setContent] = useState('')\n\n  useEffect(() => {\n    window.scrollTo(0, 0)\n    window.scrollTo = function () {};\n  }, [])\n\n\n  useEffect(() => {\n    const ws = new WebSocket(`ws://${process.env.REACT_APP_BACKEND_URL}`);\n\n    ws.onopen = () => {\n      console.log('WebSocket Connected');\n      ws.send('Hello Server!');\n    };\n\n    ws.onmessage = (event) => {\n      const message = JSON.parse(event.data);\n      if (message.action === 'new_post') {\n        setPosts(prevPosts => prevPosts.concat(message.data));\n      } else {\n        setPosts(posts.concat(message)); // Update all posts if the initial data or refresh\n      }\n    };\n\n    ws.onerror = (error) => {\n      console.log('WebSocket Error: ', error);\n    };\n\n    ws.onclose = () => {\n      console.log('WebSocket Disconnected');\n    };\n\n    return () => {\n      ws.close();\n    };\n  }, []);\n  \n  return (\n    <div id=\"chan\" style={{overflow: \"scroll\" }}>\n      <header style={{display: 'flex', flexDirection: 'column', alignItems: 'center'}}>\n        <h1 id=\"title\">33chan</h1>\n        <p style={{width: '400px', textAlign: 'center'}}><i>An anonymous imageboard.</i></p>\n        <form onSubmit={async e=>{\n            // upload to backend...\n            e.preventDefault();\n            if (file === null) {\n              alert('Please include image...')\n              return;\n            }\n            const formData = new FormData();\n            formData.append('subject', subject);\n            formData.append('content', content);\n            if (file) {\n              formData.append('file', file);\n            }\n        \n            try {\n              await axios.post(`http://${process.env.REACT_APP_BACKEND_URL}/posts`, formData, {\n                headers: {\n                  'Content-Type': 'multipart/form-data',\n                },\n              });\n              setSubject('');\n              setContent('');\n              setFilename('');\n              setFile(null);\n              alert('Post created successfully!');\n            } catch (error) {\n              console.error('Error uploading post:', error);\n              alert('Error uploading post!');\n            }\n            return false;\n          }} style={{maxWidth: \"fit-content\"}}>\n          <input name='subject' onChange={e=>setSubject(e.target.value)} value={subject} placeholder='Subject...' type=\"text\"></input><br />\n          <textarea name='content' onChange={e=>setContent(e.target.value)} value={content} placeholder='Say hi!' rows={3} cols={25}></textarea><br />\n          <input name='file' style={{width: '230px'}} onChange={e=>{setFilename(e.target.value);setFile(e.target.files[0])}} value={filename} type='file'></input><br />\n          <input type='submit'></input>\n        </form>\n      </header>\n      <hr />\n      {posts.map(p => <div className=\"post-container\">\n        <b>Subject: </b>\n        <span className='post-subject'>{p.subject}</span><br />\n        {p.file ? (\n          <img style={{\n            float: 'left',\n            maxWidth: '100px',\n            maxHeight: '100px'\n          }} src={`http://${process.env.REACT_APP_BACKEND_URL}/${p.file}`}>\n          </img>\n        ) : ''}\n        <span id=''>\n          <span className='post-content'>{p.content}</span>\n        </span>\n      </div>)}\n    </div>\n  );\n}\n\nexport default Guestbook;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}