{
  "version": 3,
  "sources": ["../bundle-xiEo0r/checked-fetch.js", "../bundle-xiEo0r/strip-cf-connecting-ip-header.js", "../../../src/files.ts", "../../../src/commands.ts", "../../../src/template.ts", "../../../src/index.ts", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-xiEo0r/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-xiEo0r/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/danielbednarski/Documents/Code/darighost.github.io/worker/.wrangler/tmp/dev-96S8Eh",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "function stripCfConnectingIPHeader(input, init) {\n\tconst request = new Request(input, init);\n\trequest.headers.delete(\"CF-Connecting-IP\");\n\treturn request;\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\treturn Reflect.apply(target, thisArg, [\n\t\t\tstripCfConnectingIPHeader.apply(null, argArray),\n\t\t]);\n\t},\n});\n", "export interface FileEntry {\n  contents: string;\n  permissions: string;\n}\n\nexport const files: Record<string, FileEntry> = {\n  'README.md': {\n    contents: `\n\"Heyyyy,\" wrote Darigo, at an ungodly hour (2 PM). \"Welcome to my home on the web!\"\n\n<p /> His face warped into an insufferable smirk. How clever (he thought) he was. The downright slutty amount of Y's that drag on just enough to make you uncomfortable. H - e - y - y - y - y.\nHis funky 90s lingo - <i>home on the web</i>. As if we weren't all digital renters now. All homeless. Unhoused, undocumented.\n8 billion eggs in one big basket. Except not even the rustic charm of a basket. Scrambling to hire just one more SRE so our entire world system doesn't collapse back\ninto horses and buggies.\n\nMaybe some downtime is exactly what this system needs.\n\nBut yeah, no. I'm just one person. You're just one person. Together we'd be two people. But nope. Sometimes, 1 and 1 <a target='_blank' href='https://www.goodreads.com/quotes/377896-one-and-one-and-one-and-one-doesn-t-equal-four'>just ain't 2</a>.\n\n<p />\n\n\"Welcome\", he said to himself, \"to my little island in a big ocean, far from the mainland\". The beach, the water, the little shack, the coconut tree. These heard him. No one else did, though. Darigo looked at a passing cloud and the glory of the bright sky ached in his eyes.\n\n<p />\"You know...\", he paused to blow out a puff of opium smoke, then continued, \"...\", but there was nothing to say, no one to whom to say it.\n\n<p />The island doesn't exist, it's still just a metaphor! But to paint a picture, suppose that this island looks exactly like Master Roshi's island from Dragonball.\n<p />Oh, right. He looked at his todo list. <i>Add social media links to README on webpage.</i> \"Fuck me\". He looked at what he'd written, compared to what he was supposed to write. \"Whatever, here's some links. Hmu.\"\n<p />\n<ul>\n<li><a target=\"_blank\" href=\"https://www.chess.com/member/darighost\">Chess.com</a></li>\n<li><a target=\"_blank\" href=\"https://news.ycombinator.com/user?id=sdsd\">HackerNews</a></li>\n<li><a target=\"_blank\" href=\"https://www.goodreads.com/user/show/149912174-darigo\">Goodreads</a></li>\n<li><a target=\"_blank\" href=\"https://x.com/darigh0st\">X</a></li>\n</ul>\n<p />As Brian & Dennis quipped in the first edition of that book about Lisp or something:<p />\n\n<div style='font-size: small;background-color: black;padding: 10px;margin-bottom: 10px;'>\n<font color='lightblue'>main()<br />\n{</font><br />\n<span style='margin-left: 13px;'><font color='magenta'>printf</font><font color='lightblue'>(</font><font color='lightgreen'>'so long and thx for all the parentheses!'</font><font color='lightblue'>);</font></span><br />\n<font color='lightblue'>}</font>\n</div>\n<p />\nAnd the rest, as they say, was mystery.<p />\n\nOH! Wait. Hey, if you're an employer reading this, check out <a target='_blank' href='/portfolio'>my portfolio</a>. And for everyone else, please click the pokeball in the bottom right corner of the page.\n<p />\nKthxbai!\n`,\n    permissions: '-rw-rw-r--'\n  },\n  'HACKME': {\n    contents: 'TODO: implement CTF in my own page here!',\n    permissions: '-r--r-----'\n  },\n  'scry.txt': {\n    permissions: '-rw-r--r--',\n    contents: `\n    I met a guy at the Assembly 2021 afterparty who explained some things about Urbit to me that a lot of people don't understand.\n<p />\nTouchy subjects like the Plunder debate and that Morlock thread from last year are hard to fully grasp when you don't have the real context behind them. There are a handful of ex Tlon employees from way back in the day who are ideologically opposed to Urbit for reasons that I've never seen anyone address, and I think it's important to shed some light on them.\n<p />\n\nThis guy at the party had been friends with Curtis for ages. Technical guy, friends with everyone at Tlon, but never got on Urbit himself.\n<p />\n\nFrom the outside, he saw an ongoing disagreement within Tlon about how thick the Urbit stack should be. Some devs didn't want to recreate the ball of mud and hence wanted to keep Urbit the smallest microkernel possible; others were more focused on usability, and thought it was more appropriate to build in vanes.\n<p />\n\nA vane is a service that the Urbit kernel can make use of. Even if you're not a programmer, you've heard of these before: Ames handles networking, Clay is the filesystem, etc. Each vane starts with a different letter of the alphabet, and in code, you often refer to them using this letter. If you want to read a file from Clay, you scry %c.\n<p />\n\nThe microkernel guys thought that this whole setup was just a little too cute. Does a diamond perfect operating system really need 26 different \"services?\" They opposed vanes from the start.\n<p />\n\nSo to push their buttons even further, a pro-vane developer got the idea one day to write a new vane: %\\u{1F480}. He thought it'd be funny to suggest that there could be an unlimited number of vanes named after any Unicode character.\n<p />\n\nIt was not funny.\n<p />\n\nThe concept behind %\\u{1F480} was genuinely useful, and simple enough: it would backup your Urbit's data in such a way that, after breaches, you could reimport it and maintain a continuous identity.\n<p />\n\nThe developer played with a few different methods for this. Initially, he thought it'd be interesting to encrypt this data and write it to chain. Because of the way that breaches work within Bridge, he figured it'd be easier to trigger some of this behavior from the Azimuth side. As I found out for myself at Vaporware, doing anything directly on Ethereum from Urbit is difficult, and the codebase can get complicated. Supposedly the developer even conceptualized a sort of proto-L2 rollup for this.\n<p />\n\nAt this point, the implementation details are fuzzy, but one way or another: it worked. The developer was able to breach his ship and continue on like nothing ever happened. It was, indeed, as innocuous as updating Windows.\n<p />\n\nThe response to this vane was similar to the response to Neal's recent tweet. Most people at Tlon agreed that, for both technical and social reasons, the version of a ship that breaches must remain dead. The core devs still feel this way. Phillip's been telling me lately how he even wants to redefine a ship to be a [rift p] to drive home how a post-breach ship is a new identity entirely.\n<p />\n\nSo the debate between simplicity and usability continued. Breaches were common back then, so this developer got a lot of opportunities to use %\\u{1F480}. He was killing and resurrecting his Urbit multiple times a week, sometimes just to prove a point. He started to get more defensive about his design decisions. He turned into a real dick.\n<p />\n\nSoon enough the other Tlon devs realized that this personality change was a result of sleep deprivation. They tried to talk to the guy about it, but eventually he stopped responding entirely. There was clearly something going on, so Galen had the guy take a few weeks off to get better.\n<p />\n\nHe did not get better.\n<p />\n\nIt turns out the guy had been having nightmares every time he went to sleep. You know those rare nightmares you got as a kid when you were really sick and hallucinating? He was having those nightmares\\u{2014}the exact same ones he'd had as a kid.\n<p />\n\nIt's psychologically reassuring to assume you have a continuous identity. You can't really operate in the world without one. But continuity isn't something you can point to; it's a clever lie our brains play on us in every moment to distract us from the reality that everything is ripped away from us every frame and re-rendered the next. Your mind is just as solid-state as your Urbit. There are no ongoing processes, only this exact moment, and then you die.\n<p />\n\nIt is only through these micro-deaths that growth is possible. To preserve a moment beyond its expiration date, to hold infinity in the palm of your hand, is to step outside the framework of time. Play back your Urbit's state history out of order. At any given state, your Urbit has no idea that the preceding state wasn't perfectly normal.\n<p />\n\nBuddhists who have these realizations talk about the dark night of the soul, a period of deep depression halfway through the spiritual path. \"Better not to begin. Once begun, better to finish.\"\n<p />\n\nBut what if you enter this dark night accidentally? What if, through some process of placebo effect and self-hypnosis, you could drive yourself to a state of endless terror in such a way that there's no escape?\n<p />\n\nThe %\\u{1F480} developer never came back to Tlon. After a few weeks, he dropped off the face of the Earth. Most people think he's probably still alive.\n<p />\n\nThere was no mystery to the Tlon guys about what was going on here. Urbit developers have always been a lot more spiritual than your average tech guy. It's why we all love Book of the New Sun so much:\n<p />\n\n\"We believe that we invent symbols. The truth is that they invent us; we are their creatures, shaped by their hard, defining edges. When soldiers take their oath they are given a coin, an asimi stamped with the profile of the Autarch. Their acceptance of that coin is their acceptance of the special duties and burdens of military life\\u{2014}they are soldiers from that moment, though they may know nothing of the management of arms. I did not know that then, but it is a profound mistake to believe that we must know of such things to be influenced by them, and in fact to believe so is to believe in the most debased and superstitious kind of magic. The would-be sorcerer alone has faith in the efficacy of pure knowledge; rational people know that things act of themselves or not at all.\"\n<p />\n\nAs any Hoon programmer can tell you, casting runes does indeed shape your mind in ways impossible to articulate through language. It was completely feasible both to Tlon then and to me now that the developer of %\\u{1F480} had driven himself mad through repeated exposure to that dark ritual that sustains one's soul across breaches.\n<p />\n\nIn the aftermath, both the microkernel people and the usability people agreed to scrub %\\u{1F480} from the Urbit git repo. But if you look deep enough in the kernel, you can still see its remnants. Weirdly named types that reference the old code, useless arms that don't get called anymore. Neal jokes about this stuff in Core Academy sometimes. No, I won't tell you where to find it.\n<p />\n\nPersonally, I can't help but worry about this latent functionality. There are phantoms on the Urbit network, lying dormant within our ships, hopping to others when the opportunity arises. Just yesterday, ~minder-folden's ship acked a dot from %sicdev-pilnup that he had sent last December. Where was this response hiding all this time? In some Ames queue? Nobody knows. My Groups and Talk apps have been errored all week despite supposedly receiving OTAs from the same distro moon as everyone else, and Tlon can't explain why. What update put my ship in this strange state?\n<p />\n\nThe \\u{1F480} vane is gone for now. But it's only a matter of time before someone plugs in some old Native Planet box that's still syncing updates from a forgotten star. Or before ~littel-wolfur's massive Ames log releases whatever otherworldy entities have been brewing in there for the past decade. Or before an errant dev comet with outdated software sends you a message and gets you to install \"their first app after graduating hoon school.\"\n<p />\n\nDid you know that a new vane, %lick, is on your ship now, after the latest update? When %\\u{1F480} does make its way to your ship, it will do so similarly quietly. You won't even know it's there.\n<p />\n\nIf you've never breached, you likely have nothing to worry about. But the more you breach, the more you will see %\\u{1F480}'s manifestations.\n<p />\n\nFor those of you who don't know what the .\\u{005E} rune does, don't look it up. Do not tempt yourself just to \"see what would happen.\"\n<p />\n\nAnd for those of you who do know: do not ever scry %\\u{1F480}.\n<p />\n\n<a target=\"_blank\" href=\"https://twitter.com/hanfel_dovned/status/1715055895347114093\">x/~hanfel-dovned</a>\n    `\n  },\n  '.somefile.txt': {\n    contents: 'TODO: implement CTF in my own page here!',\n    permissions: '-r--r--r--'\n  }\n};\n", "import { files } from './files';\n\nfunction escapeHtml(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport interface CommandResult {\n  output: string;\n  instant?: boolean;\n  clear?: boolean;\n}\n\nexport function handleCommand(cmd: string): CommandResult {\n  const parts = cmd.trim().split(/\\s+/);\n  const command = parts[0]?.toLowerCase() ?? '';\n  const argument = parts[1];\n\n  switch (command) {\n    case '':\n      return { output: '', instant: true };\n\n    case 'ls':\n      return {\n        output: Object.keys(files)\n          .filter(name => !name.startsWith('.'))\n          .map(name => `${files[name].permissions} ${name}`)\n          .join('<br />')\n      };\n\n    case 'who':\n      return {\n        output: `Darigo.<p />Sabreur, <a target=\"_blank\" href=\"https://git.lain.church/darighost\">rogue dev</a>, quirked up white boi.<p />`\n      };\n\n    case 'cat': {\n      if (!argument) {\n        return { output: 'Usage: cat &lt;filename&gt;' };\n      }\n      if (!(argument in files)) {\n        return { output: 'The file you entered does not exist' };\n      }\n      return {\n        output: files[argument].contents,\n        instant: true\n      };\n    }\n\n    case 'ps':\n      return {\n        output: [\n          'PID TTY          TIME CMD',\n          '  1 tty1     00:00:00 darigo.su',\n          '  2 tty1     00:00:00 <a target=\"_blank\" href=\"https://github.com/darighost\">github</a>',\n        ].join('<br />')\n      };\n\n    default:\n      return { output: 'Unknown command.' };\n  }\n}\n", "export interface TemplateOptions {\n  cmdEcho?: string;\n  output: string;\n  instant?: boolean;\n  clear?: boolean;\n}\n\nfunction buildTypewriterLines(html: string): string {\n  const lines = html.split('<br />');\n  if (lines.length > 5) {\n    return `<div class=\"cmd-output\">${html}</div>`;\n  }\n\n  let delay = 0;\n  const spans = lines.map(line => {\n    const textLen = line.replace(/<[^>]*>/g, '').length;\n    const charCount = Math.max(textLen, 1);\n    const span = `<span style=\"--chars:${charCount};--delay:${delay}ms\">${line}</span>`;\n    delay += charCount * 28 + 100;\n    return span;\n  });\n\n  return `<div class=\"cmd-output typewriter\">${spans.join('\\n')}</div>`;\n}\n\nexport function renderPage(opts: TemplateOptions): string {\n  const { cmdEcho, output, instant, clear } = opts;\n  const prompt = 'guest@darigo.su:~ $&nbsp;';\n\n  let outputSection = '';\n  if (cmdEcho !== undefined && !clear && output) {\n    if (instant) {\n      outputSection = `<div class=\"cmd-output\">${output}</div>`;\n    } else {\n      outputSection = buildTypewriterLines(output);\n    }\n  }\n\n  const welcomeSection = clear ? '' : `\n    <div class=\"welcome\">\n      Welcome to <a target=\"_blank\" href=\"https://github.com/darighost\">D-WOS \\u24B6</a> (Dari's Web OS)<br />\n      Commands: <b>ls</b>, <b>cat</b>, <b>who</b>, <b>ps</b>\n    </div>`;\n\n  return `<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n<link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n<link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin />\n<link href=\"https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible+Mono&display=swap\" rel=\"stylesheet\" />\n<style>\n  * { margin: 0; padding: 0; box-sizing: border-box; }\n  html, body {\n    height: 100%;\n    background: transparent;\n    font-family: 'Atkinson Hyperlegible Mono', monospace;\n    font-size: 16px;\n    color: #4a4a49;\n  }\n  a { color: black; text-decoration: underline dashed 2px; text-underline-offset: 4px; }\n  #terminal {\n    overflow-y: auto;\n    max-height: 400px;\n  }\n  .welcome { margin-bottom: 1em; }\n  .cmd-output { margin-top: 0.25em; }\n\n  .typewriter span {\n    display: block;\n    overflow: hidden;\n    white-space: nowrap;\n    max-width: 0;\n    animation: type calc(var(--chars) * 28ms) steps(var(--chars)) var(--delay) forwards;\n  }\n  @keyframes type {\n    to { max-width: 100%; }\n  }\n\n  form {\n    display: flex;\n    align-items: center;\n    margin-top: 0.5em;\n  }\n  form label {\n    white-space: nowrap;\n    flex-shrink: 0;\n  }\n  form input {\n    flex: 1;\n    border: none;\n    outline: none;\n    font-family: inherit;\n    font-size: inherit;\n    color: inherit;\n    background: transparent;\n    caret-color: #4a4a49;\n  }\n</style>\n</head>\n<body>\n  <div id=\"terminal\">\n    ${welcomeSection}\n    <form method=\"GET\" action=\"/terminal\">\n      <label>${prompt}</label>\n      <input type=\"text\" name=\"cmd\" autocomplete=\"off\" autofocus spellcheck=\"false\" />\n    </form>\n    ${outputSection}\n  </div>\n</body>\n</html>`;\n}\n", "import { handleCommand } from './commands';\nimport { renderPage } from './template';\n\nfunction escapeHtml(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\ninterface Env {\n  ASSETS: { fetch(request: Request): Promise<Response> };\n}\n\nexport default {\n  async fetch(request: Request, env: Env): Promise<Response> {\n    const url = new URL(request.url);\n\n    // Terminal route\n    if (url.pathname === '/terminal') {\n      const cmd = url.searchParams.get('cmd') ?? '';\n\n      const headers = new Headers({\n        'Content-Type': 'text/html; charset=utf-8',\n      });\n\n      if (!cmd && !url.searchParams.has('cmd')) {\n        const html = renderPage({ output: '', instant: true });\n        return new Response(html, { headers });\n      }\n\n      const result = handleCommand(cmd);\n\n      const html = renderPage({\n        cmdEcho: escapeHtml(cmd),\n        output: result.output,\n        instant: result.instant,\n        clear: result.clear,\n      });\n\n      return new Response(html, { headers });\n    }\n\n    // Everything else: static assets (React app at /, sigil.webm, etc.)\n    return env.ASSETS.fetch(request);\n  },\n};\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/src/index.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/src/index.ts\";\n\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/.wrangler/tmp/bundle-xiEo0r/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/.wrangler/tmp/bundle-xiEo0r/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/danielbednarski/Documents/Code/darighost.github.io/worker/.wrangler/tmp/bundle-xiEo0r/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": ["html"]
}
